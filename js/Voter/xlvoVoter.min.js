var xlvoVoter={init:function(a){var b=a,c=/amp;/g;b.base_url=b.base_url.replace(c,""),this.config=b,this.ready=!0,xlvoVoter.config.use_mathjax&&!!MathJax&&MathJax.Hub.Config({"HTML-CSS":{scale:80}})},config:{base_url:"",cmd_voting_data:"",lng:{player_seconds:"s"},debug:!1,delay:1e3},player:{frozen:!0,active_voting_id:0,status:-1,countdown:0,has_countdown:!1,countdown_classname:""},delay:1e3,counter:0,forced_update:300,timeout:null,data:null,run:function(){this.loadVotingData(),this.initElements()},initElements:function(){this.countdown_element=$("#xlvo_countdown"),this.player_element=$("#xlvo_voter_player")},loadVotingData:function(){$.get(xlvoVoter.config.base_url,{cmd:"getVotingData"}).done(function(a){xlvoVoter.log(a),xlvoVoter.interval&&(clearInterval(xlvoVoter.interval),xlvoVoter.interval=null);var b=xlvoVoter.player.active_voting_id!==a.active_voting_id,c=xlvoVoter.player.status!==a.status,d=xlvoVoter.counter>xlvoVoter.forced_update,e=xlvoVoter.player.frozen!==a.frozen,f=xlvoVoter.player.show_results!==a.show_results,g=xlvoVoter.player.show_correct_order!==a.show_correct_order;xlvoVoter.player=a,c||b||d||e||f||g?(xlvoVoter.log("Replace HTML & Handle Countdown"),xlvoVoter.log("status_has_changed:"+c),xlvoVoter.log("voting_has_changed:"+b),xlvoVoter.log("forced_update:"+d),xlvoVoter.log("frozen_changed:"+e),xlvoVoter.log("show_results_changed:"+f),xlvoVoter.log("show_correct_order_changed:"+g),xlvoVoter.replaceHTML(xlvoVoter.handleCountdown)):(xlvoVoter.log("handleCountdown"),xlvoVoter.handleCountdown()),xlvoVoter.log("Set TimeOut"),xlvoVoter.timeout=setTimeout(xlvoVoter.loadVotingData,xlvoVoter.config.delay),xlvoVoter.counter++}).fail(function(){xlvoVoter.timeout=setTimeout(xlvoVoter.loadVotingData,xlvoVoter.config.delay)})},replaceHTML:function(a){xlvoVoter.log("replace"),a=a?a:function(){},$.get(xlvoVoter.config.base_url,{cmd:"getHTML"}).done(function(b){xlvoVoter.data!==b&&(xlvoVoter.log(b),xlvoVoter.player_element.replaceWith("<div id=\"xlvo_voter_player\">"+b+"</div>"),xlvoVoter.config.use_mathjax&&!!MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,"xlvo_voter_player"]),xlvoVoter.counter=0,xlvoVoter.player_element=$("#xlvo_voter_player"),xlvoVoter.countdown_element=$("#xlvo_countdown")),a()})},handleCountdown:function(){xlvoVoter.player.has_countdown?(xlvoVoter.log("has countdown: "+(xlvoVoter.player.has_countdown?"yes, "+xlvoVoter.player.countdown:"no")),xlvoVoter.countdown_element.removeClass(),xlvoVoter.countdown_element.text(xlvoVoter.player.countdown.toString()+" "+xlvoVoter.config.lng.player_seconds),xlvoVoter.countdown_element.show(),xlvoVoter.countdown_element.addClass("label label-cd-"+xlvoVoter.player.countdown_classname),xlvoVoter.interval=setInterval(xlvoVoter.countDown,1e3)):(xlvoVoter.countdown_element.removeClass(),xlvoVoter.countdown_element.hide())},countDown:function(){xlvoVoter.player.has_countdown&&(xlvoVoter.player.countdown--,0<xlvoVoter.player.countdown&&xlvoVoter.countdown_element.text(xlvoVoter.player.countdown.toString()+" "+xlvoVoter.config.lng.player_seconds))},log:function(a){xlvoVoter.config.debug&&console.log(a)},debug:function(){this.config.debug=!0},stop:function(){this.config.debug=!1}};